<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Valentine for Priyadharsan</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --pink-50: #fff4f8;
        --pink-100: #ffd9e7;
        --pink-200: #ffbcd5;
        --pink-300: #ff9cc2;
        --purple-100: #f1e8ff;
        --purple-200: #ddc6ff;
        --purple-300: #c7a8ff;
        --purple-400: #b08cff;
        --white: #ffffff;
        --text-dark: #4a235a;
        --text-soft: #7a4b85;
        --shadow: 0 20px 60px rgba(255, 140, 200, 0.25);
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        height: 100%;
        overflow: hidden;
      }

      body {
        min-height: 100vh;
        background: radial-gradient(circle at top, var(--pink-50), var(--purple-100));
        font-family: "Baloo 2", sans-serif;
        color: var(--text-dark);
      }

      body::before {
        content: "";
        position: fixed;
        inset: 0;
        background: radial-gradient(circle at 15% 20%, rgba(255, 255, 255, 0.6), transparent 50%),
          radial-gradient(circle at 85% 10%, rgba(255, 214, 235, 0.6), transparent 45%),
          radial-gradient(circle at 50% 90%, rgba(221, 198, 255, 0.5), transparent 55%);
        pointer-events: none;
        z-index: 0;
      }

      .app {
        position: relative;
        z-index: 1;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 48px 16px 96px;
      }

      .card {
        width: min(860px, 92vw);
        background: rgba(255, 255, 255, 0.85);
        border-radius: 32px;
        padding: 48px 32px;
        box-shadow: var(--shadow);
        backdrop-filter: blur(10px);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 24px;
        border: 1px solid rgba(255, 180, 215, 0.6);
        animation: fadeIn 0.9s ease;
      }

      .title {
        font-family: "Pacifico", cursive;
        font-size: clamp(2.2rem, 5vw, 3.4rem);
        text-align: center;
        color: var(--text-dark);
        margin: 0;
      }

      .subtitle {
        font-size: clamp(1.1rem, 2.8vw, 1.6rem);
        text-align: center;
        color: var(--text-soft);
        margin: 0;
      }

      .image-card {
        width: min(420px, 80vw);
        background: linear-gradient(140deg, rgba(255, 240, 248, 0.95), rgba(230, 212, 255, 0.85));
        border-radius: 28px;
        padding: 20px;
        display: grid;
        place-items: center;
        box-shadow: 0 18px 40px rgba(163, 110, 190, 0.25);
        border: 1px solid rgba(255, 160, 205, 0.5);
        animation: popIn 0.6s ease;
      }

      .image-card svg {
        width: 100%;
        height: auto;
        display: block;
      }

      .plea {
        font-size: clamp(1rem, 2.6vw, 1.4rem);
        color: var(--text-soft);
        font-weight: 600;
        margin: 0;
      }

      .actions {
        display: flex;
        gap: 18px;
        flex-wrap: wrap;
        justify-content: center;
      }

      .btn {
        border: none;
        border-radius: 999px;
        padding: 14px 34px;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 0 16px 30px rgba(255, 160, 205, 0.3);
      }

      .btn-yes {
        background: linear-gradient(135deg, var(--pink-200), var(--purple-200));
        color: var(--text-dark);
      }

      .btn-no {
        background: linear-gradient(135deg, var(--pink-100), var(--white));
        color: var(--text-soft);
      }

      .btn:focus-visible {
        outline: 3px solid var(--purple-300);
        outline-offset: 3px;
      }

      .btn:hover {
        transform: translateY(-2px) scale(1.03);
      }

      .hearts {
        position: fixed;
        inset: 0;
        pointer-events: none;
        overflow: hidden;
        z-index: 0;
      }

      .heart {
        position: absolute;
        bottom: -60px;
        width: 26px;
        height: 26px;
        background: var(--pink-200);
        transform: rotate(45deg);
        animation: floatUp 10s linear infinite;
        opacity: 0.85;
      }

      .heart::before,
      .heart::after {
        content: "";
        position: absolute;
        width: 26px;
        height: 26px;
        background: var(--pink-200);
        border-radius: 50%;
      }

      .heart::before {
        left: -13px;
      }

      .heart::after {
        top: -13px;
      }

      .heart.purple,
      .heart.purple::before,
      .heart.purple::after {
        background: var(--purple-200);
      }

      .success-overlay {
        position: fixed;
        inset: 0;
        background: linear-gradient(160deg, rgba(255, 210, 231, 0.95), rgba(214, 198, 255, 0.95));
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        z-index: 5;
        animation: fadeIn 0.8s ease;
        padding: 32px 18px;
      }

      .success-card {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 34px;
        padding: 48px 32px;
        box-shadow: 0 22px 60px rgba(169, 115, 212, 0.3);
        max-width: 620px;
        width: 90vw;
        animation: popIn 0.8s ease;
      }

      .success-title {
        font-family: "Pacifico", cursive;
        font-size: clamp(2rem, 5vw, 3rem);
        margin: 0 0 16px;
      }

      .success-text {
        font-size: clamp(1.1rem, 2.6vw, 1.5rem);
        margin: 0;
        color: var(--text-soft);
      }

      .music-note {
        font-size: 1rem;
        margin-top: 16px;
        color: var(--text-soft);
      }

      @keyframes floatUp {
        0% {
          transform: translateY(0) rotate(45deg) scale(0.8);
          opacity: 0;
        }
        10% {
          opacity: 0.9;
        }
        100% {
          transform: translateY(-120vh) rotate(45deg) scale(1.2);
          opacity: 0;
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(12px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes popIn {
        from {
          transform: scale(0.9);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      @media (max-width: 640px) {
        .card {
          padding: 36px 20px;
        }

        .actions {
          gap: 12px;
        }

        .btn {
          padding: 12px 26px;
        }
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useEffect, useMemo, useRef, useState } = React;

      const STORAGE_KEY = "valentine_priyadharsan_state_v1";

      const svgImages = [
        `<?xml version="1.0" encoding="UTF-8"?>
        <svg viewBox="0 0 360 280" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="bg1" x1="0" x2="1" y1="0" y2="1">
              <stop offset="0%" stop-color="#ffd9e7"/>
              <stop offset="100%" stop-color="#e9d4ff"/>
            </linearGradient>
          </defs>
          <rect width="360" height="280" rx="26" fill="url(#bg1)"/>
          <circle cx="130" cy="150" r="70" fill="#ffe7f2"/>
          <circle cx="230" cy="150" r="70" fill="#ffe7f2"/>
          <circle cx="110" cy="120" r="18" fill="#5a2b71"/>
          <circle cx="250" cy="120" r="18" fill="#5a2b71"/>
          <circle cx="110" cy="120" r="8" fill="#fff"/>
          <circle cx="250" cy="120" r="8" fill="#fff"/>
          <path d="M155 170 q25 18 50 0" stroke="#5a2b71" stroke-width="8" fill="none" stroke-linecap="round"/>
          <path d="M155 95 q25 -30 50 0" fill="#ff9cc2"/>
          <path d="M115 70 l-30 -30" stroke="#ff9cc2" stroke-width="6" stroke-linecap="round"/>
          <path d="M245 70 l30 -30" stroke="#ff9cc2" stroke-width="6" stroke-linecap="round"/>
          <text x="180" y="245" font-size="22" text-anchor="middle" fill="#7a4b85" font-family="Baloo 2">Teddy hugs</text>
        </svg>`,
        `<?xml version="1.0" encoding="UTF-8"?>
        <svg viewBox="0 0 360 280" xmlns="http://www.w3.org/2000/svg">
          <rect width="360" height="280" rx="26" fill="#ffeaf3"/>
          <circle cx="180" cy="130" r="70" fill="#fff1d6"/>
          <circle cx="120" cy="90" r="28" fill="#fff1d6"/>
          <circle cx="240" cy="90" r="28" fill="#fff1d6"/>
          <circle cx="155" cy="125" r="10" fill="#6b3a6f"/>
          <circle cx="205" cy="125" r="10" fill="#6b3a6f"/>
          <circle cx="155" cy="125" r="4" fill="#fff"/>
          <circle cx="205" cy="125" r="4" fill="#fff"/>
          <path d="M172 150 q8 10 16 0" stroke="#6b3a6f" stroke-width="5" fill="none" stroke-linecap="round"/>
          <path d="M150 170 q30 25 60 0" stroke="#ff9cc2" stroke-width="7" fill="none" stroke-linecap="round"/>
          <path d="M140 200 q40 20 80 0" fill="#ffc0d8"/>
          <text x="180" y="245" font-size="22" text-anchor="middle" fill="#7a4b85" font-family="Baloo 2">Cute puppy</text>
          <path d="M270 70 q20 -24 40 0 q0 26 -20 38 q-20 -12 -20 -38z" fill="#ff9cc2"/>
        </svg>`,
        `<?xml version="1.0" encoding="UTF-8"?>
        <svg viewBox="0 0 360 280" xmlns="http://www.w3.org/2000/svg">
          <rect width="360" height="280" rx="26" fill="#f3e7ff"/>
          <circle cx="130" cy="120" r="50" fill="#ffe0ec"/>
          <circle cx="230" cy="120" r="50" fill="#ffe0ec"/>
          <path d="M90 165 q40 35 80 10" fill="#ffd3e5"/>
          <path d="M190 175 q40 25 80 -5" fill="#ffd3e5"/>
          <circle cx="115" cy="115" r="8" fill="#5a2b71"/>
          <circle cx="245" cy="115" r="8" fill="#5a2b71"/>
          <path d="M120 135 q10 10 20 0" stroke="#5a2b71" stroke-width="4" fill="none" stroke-linecap="round"/>
          <path d="M220 135 q10 10 20 0" stroke="#5a2b71" stroke-width="4" fill="none" stroke-linecap="round"/>
          <path d="M180 175 q30 -40 60 0 q0 40 -30 55 q-30 -15 -30 -55z" fill="#ff9cc2"/>
          <text x="180" y="245" font-size="22" text-anchor="middle" fill="#7a4b85" font-family="Baloo 2">Chibi couple</text>
        </svg>`,
        `<?xml version="1.0" encoding="UTF-8"?>
        <svg viewBox="0 0 360 280" xmlns="http://www.w3.org/2000/svg">
          <rect width="360" height="280" rx="26" fill="#ffe6f2"/>
          <circle cx="180" cy="115" r="55" fill="#f7d7ff"/>
          <circle cx="150" cy="110" r="12" fill="#5a2b71"/>
          <circle cx="210" cy="110" r="12" fill="#5a2b71"/>
          <path d="M165 135 q15 14 30 0" stroke="#5a2b71" stroke-width="5" fill="none" stroke-linecap="round"/>
          <path d="M100 180 q80 60 160 0" fill="#ffd1e6"/>
          <path d="M120 190 q60 40 120 0" fill="#ffbcd5"/>
          <path d="M240 70 q20 -24 40 0 q0 26 -20 38 q-20 -12 -20 -38z" fill="#ff9cc2"/>
          <path d="M80 70 q20 -24 40 0 q0 26 -20 38 q-20 -12 -20 -38z" fill="#ff9cc2"/>
          <text x="180" y="245" font-size="22" text-anchor="middle" fill="#7a4b85" font-family="Baloo 2">Love hugs</text>
        </svg>`
      ];

      const encodeSvg = (svg) =>
        `data:image/svg+xml;utf8,${encodeURIComponent(svg)}`;

      const noQuestions = [
        "Priyadharsan ü•∫üíó\nWill you be my Valentine?",
        "Priyadharsan ü•πüíû\nPlease be my Valentine?",
        "Priyadharsan üòΩüíï\nSay yes and make me smile?",
        "Priyadharsan ü´∂üíó\nPretty please be my Valentine?",
        "Priyadharsan üå∏üíò\nCan I be your Valentine?",
        "Priyadharsan üêªüíó\nMy heart says yes... yours too?",
        "Priyadharsan üíó‚ú®\nLet‚Äôs make this Valentine special?",
        "Priyadharsan ü•∞üíñ\nPlease say yes, cutie?"
      ];

      const defaultState = {
        accepted: false,
        noCount: 0,
        imageIndex: 0
      };

      const App = () => {
        const [state, setState] = useState(defaultState);
        const [showSuccess, setShowSuccess] = useState(false);
        const audioRef = useRef(null);

        useEffect(() => {
          const stored = localStorage.getItem(STORAGE_KEY);
          if (stored) {
            try {
              const parsed = JSON.parse(stored);
              setState({ ...defaultState, ...parsed });
              if (parsed.accepted) {
                setShowSuccess(true);
              }
            } catch (error) {
              setState(defaultState);
            }
          }
        }, []);

        useEffect(() => {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        }, [state]);

        const hearts = useMemo(() => {
          return Array.from({ length: 22 }, (_, index) => ({
            id: index,
            left: Math.random() * 100,
            delay: Math.random() * -12,
            duration: 8 + Math.random() * 8,
            purple: Math.random() > 0.55
          }));
        }, []);

        const handleYes = () => {
          setState((prev) => ({ ...prev, accepted: true }));
          setShowSuccess(true);
          startRomanticMusic();
        };

        const handleNo = () => {
          setState((prev) => {
            const nextIndex = (prev.imageIndex + 1) % svgImages.length;
            return {
              ...prev,
              noCount: prev.noCount + 1,
              imageIndex: nextIndex
            };
          });
        };

        const startRomanticMusic = () => {
          if (audioRef.current) {
            return;
          }
          const context = new (window.AudioContext || window.webkitAudioContext)();
          const master = context.createGain();
          master.gain.value = 0.12;
          master.connect(context.destination);
          audioRef.current = { context, master };

          const chords = [
            [261.63, 329.63, 392.0],
            [293.66, 369.99, 440.0],
            [246.94, 311.13, 392.0],
            [220.0, 277.18, 329.63]
          ];

          let chordIndex = 0;
          const playChord = () => {
            const now = context.currentTime;
            const chord = chords[chordIndex];
            chordIndex = (chordIndex + 1) % chords.length;

            chord.forEach((freq) => {
              const osc = context.createOscillator();
              const gain = context.createGain();
              osc.type = "triangle";
              osc.frequency.value = freq;
              gain.gain.setValueAtTime(0, now);
              gain.gain.linearRampToValueAtTime(0.2, now + 0.4);
              gain.gain.linearRampToValueAtTime(0.0001, now + 3.8);
              osc.connect(gain);
              gain.connect(master);
              osc.start(now);
              osc.stop(now + 4);
            });
          };

          playChord();
          const intervalId = setInterval(playChord, 4000);
          audioRef.current.intervalId = intervalId;
        };

        const question = state.noCount > 0
          ? noQuestions[state.noCount % noQuestions.length]
          : "Priyadharsan üíñ\nWill you be my Valentine?";

        const yesScale = 1 + state.noCount * 0.08;
        const noScale = Math.max(0.7, 1 - state.noCount * 0.06);
        const currentImage = encodeSvg(svgImages[state.imageIndex]);

        return (
          <>
            <div className="hearts">
              {hearts.map((heart) => (
                <span
                  key={heart.id}
                  className={`heart ${heart.purple ? "purple" : ""}`}
                  style={{
                    left: `${heart.left}%`,
                    animationDelay: `${heart.delay}s`,
                    animationDuration: `${heart.duration}s`
                  }}
                />
              ))}
            </div>

            <div className="app">
              <div className="card">
                <h1 className="title">
                  {question.split("\n").map((line, index) => (
                    <span key={index}>
                      {line}
                      <br />
                    </span>
                  ))}
                </h1>

                {state.noCount > 0 && !state.accepted && (
                  <>
                    <div className="image-card">
                      <img src={currentImage} alt="Cute romantic illustration" />
                    </div>
                    <p className="plea">Pleaseee say yes üíï</p>
                  </>
                )}

                <div className="actions">
                  <button
                    className="btn btn-yes"
                    onClick={handleYes}
                    style={{ transform: `scale(${yesScale})` }}
                  >
                    ‚úÖ Yes
                  </button>
                  <button
                    className="btn btn-no"
                    onClick={handleNo}
                    style={{ transform: `scale(${noScale})` }}
                  >
                    ‚ùå No
                  </button>
                </div>
              </div>
            </div>

            {showSuccess && (
              <div className="success-overlay">
                <div className="success-card">
                  <h2 className="success-title">
                    Yayyy Priyadharsan ü•πüíñ
                  </h2>
                  <p className="success-text">
                    You said YES!<br />
                    I‚Äôm the happiest person in the world üíï
                  </p>
                  <p className="music-note">Soft music is playing just for us.</p>
                </div>
              </div>
            )}
          </>
        );
      };

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
